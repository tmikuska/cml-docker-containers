#
# syslog node definition
# generated 2025-04-01
# part of VIRL^2
#

id: syslog
configuration:
  generator:
    driver: server
  provisioning:
    volume_name: cfg
    media_type: raw
    files:
      - name: config.json
        editable: false
        content: |
          {
            "docker": {
              "image": "{{IMAGENAMETAG}}",
              "mounts": [
                "type=bind,source=cfg/boot.sh,target=/boot.sh",
                "type=bind,source=cfg/syslog-ng.conf,target=/etc/syslog-ng/syslog-ng.conf"
              ]
            },
            "shell": "/bin/bash",
            "day0cmd": [ "/bin/bash", "/boot.sh" ],
            "busybox": true
          }
      - name: syslog-ng.conf
        editable: true
        content: |
          #############################################################################
          # Default syslog-ng.conf file which collects all local logs into a
          # single file called /var/log/messages tailored to container usage.

          @version: 3.38

          options {
              # enable verbose logging (needs 4.0)
              # log-level(verbose);

              # enable debug messages
              # stats_freq(1);  # Update statistics every 1 second
              flush_lines(0);
          };

          source s_network {
              udp(port(514));
          };

          destination d_local {
              file("/var/log/syslog");
          };

          destination d_stdout {
              # send logs to stdout
              file("/dev/stdout");
          };

          log {
              source(s_network);
              destination(d_stdout);
              destination(d_local);
          };

      - name: boot.sh
        editable: true
        content: |
          # insert more commands here
          # ip address add dev eth1 10.0.0.1/24
          # ip link set dev eth1 up
          #
          # keep the next line to indicate that the machine is ready
          echo "READY" >/dev/console
          exit 0
device:
  interfaces:
    has_loopback_zero: false
    min_count: 1
    default_count: 4
    management:
      - eth0
    physical:
      - eth0
      - eth1
      - eth2
      - eth3
    serial_ports: 2
inherited:
  image:
    ram: true
    cpus: true
    cpu_limit: true
    data_volume: false
    boot_disk_size: false
  node:
    ram: true
    cpus: true
    cpu_limit: true
    data_volume: false
    boot_disk_size: false
general:
  description: Syslog NG server
  nature: server
  read_only: true
schema_version: 0.0.1
sim:
  linux_native:
    cpus: 1
    ram: 512
    driver: server
    libvirt_domain_driver: docker
boot:
  timeout: 30
  completed:
    - READY
ui:
  description: |
    Syslog NG server {{CMLNODEDEFVERSION}}
  group: Others
  icon: server
  label: Syslog
  label_prefix: syslog-
  visible: true
